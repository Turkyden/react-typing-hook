{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import { useEffect, RefObject } from \"react\";\r\nimport './index.css'\r\n\r\n/**\r\n * React Hook Wrapper\r\n * @param ref \r\n * @param param1 \r\n */\r\nexport default function useTyping(ref: RefObject<HTMLDocument | null>, { steps, loop, speed = 60 } : TypingOptions) {\r\n\r\n  async function typing(node: HTMLDocument, speed: number, ...args: TypingSteps): Promise<void> {\r\n    for (const arg of args) {\r\n      switch (typeof arg) {\r\n        case \"string\":\r\n          await edit(node, speed, arg);\r\n          break;\r\n        case \"number\":\r\n          await wait(arg);\r\n          break;\r\n        case \"function\":\r\n          await arg(node, speed, ...args);\r\n          break;\r\n        default:\r\n          await arg;\r\n      }\r\n    }\r\n  }\r\n\r\n  async function edit(node: HTMLDocument, speed: number, text: string): Promise<void> {\r\n    const textContent = node.textContent || '';\r\n    const overlap = getOverlap(textContent, text);\r\n    await perform(node, speed, [\r\n      ...deleter(textContent, overlap) as Iterable<string>,\r\n      ...writer(text, overlap) as Iterable<string>,\r\n    ]);\r\n  }\r\n\r\n  async function wait(ms: number): Promise<void> {\r\n    await new Promise((resolve) => setTimeout(resolve, ms));\r\n  }\r\n\r\n  async function perform(node: HTMLDocument, speed: number, edits: Iterable<string>): Promise<void> {\r\n    for (const op of editor(edits) as Iterable<Editor>) {\r\n      op(node);\r\n      await wait(speed + speed * (Math.random() - 0.5));\r\n    }\r\n  }\r\n\r\n  function* editor(edits: Iterable<string>): GeneratorEditor {\r\n    for (const edit of edits) {\r\n      yield (node: HTMLDocument) => requestAnimationFrame(() => (node.textContent = edit));\r\n    }\r\n  }\r\n\r\n  function* writer([...text]: Iterable<string>, startIndex = 0, endIndex = text.length): Generator<string, void, string> {\r\n    while (startIndex < endIndex) {\r\n      yield text.slice(0, ++startIndex).join(\"\");\r\n    }\r\n  }\r\n\r\n  function* deleter([...text]: Iterable<string>, startIndex = 0, endIndex = text.length): Generator<string, void, string> {\r\n    while (endIndex > startIndex) {\r\n      yield text.slice(0, --endIndex).join(\"\");\r\n    }\r\n  }\r\n\r\n  function getOverlap(start: string, [...end]: string): number {\r\n    return [...start, NaN].findIndex((char, i) => end[i] !== char);\r\n  }\r\n\r\n  const loopedType = typing;\r\n\r\n  useEffect(() => {\r\n    if(ref.current === null) return undefined;\r\n    \r\n    if (loop === Infinity) {\r\n      typing(ref.current, speed, ...steps, loopedType);\r\n    } else if (typeof loop === \"number\") {\r\n      typing(\r\n        ref.current,\r\n        speed,\r\n        ...Array(loop)\r\n          .fill(steps)\r\n          .flat()\r\n      );\r\n    } else {\r\n      typing(ref.current, speed, ...steps);\r\n    }\r\n  });\r\n}\r\n\r\n"],"names":["useEffect"],"mappings":"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"}